# Rybov

Point-n-Click рыбалка, в которой рыбу нужно не только поймать, но и защитить от котов.

Чем больше игрок сохранил рыбы за отведённое время, и чем круче эта рыба, тем больше игрок получит очков.


## Игрок

Всё взаимодействие с игрой игрок осуществляет с помощью мыши. Аватар игрока это курсор, представленный в виде ладони.

Игрок может перетаскивать [выловленную рыбу](#выловленная-рыба), взаимодействовать с [удочкой](#удочка), бить [котов](#коты) и другие `IFloppable` сущности.

### Удары

Игрок может ударять [котов](#коты) с разной степень силы. Сила удара зависит от времени заряда удара - чем дольше заряжается, тем мощнее.

Удар можно разделаить на три типа:
- Шлепок -- стаггер или микростан.
- Щелбан -- длинного стана.
- Убер-щелбан -- можщный удар, который выкидывает [котов](#коты) с [игрового поля](#игровое-поле).


## Игровое поле

Есть земля, по которой ходят [коты](#коты), и есть озеро, из которого вылавливается рыба.

[Удочка](#удочка) находится ближе к воде для того чтобы она не пересекалась с другими игровыми сущностями.

Локация должна легко редактироваться.

### Пропсы

На игровом поле есть интерактивные объекты, которые являются препятствиями для [котов](#коты) и развлечением для [игрока](#игрок) (при условии, если они интерактивные, `IFloppable`).


## Глобальное игровое состояние

Игра должна отслеживать своё игровое состояние. Предполагается, что это будет происходить в отдельном синглтоне, который будет заниматься подгрузкой уровней, подсчётом [очков](#очки) и управлением временем игры.

### Стадии игры

Игра делится на стадии. В каждой стадии есть свои особенности и у каждой стадии есть свои геймплейные задачи.

#### Start

Особое состояние, которое мы пока никак не будем использовать, но на всякий случай выделим отдельно. Игра переходит в следующее состояние сразу же после этого.

#### Assault

Обычный игровой процесс. Длится какое-то определённое время, которое задаётся дизайнером для уровня.

#### Fleeing

Триумф игрока. Все [коты](#коты) без [рыбы](#рыба) разбегаются и [рыба](#рыба) перестаёт клевать.

[Игрок](#игрок) всё ещё может [доловить](#удочка) рыбу на крючке, если клевать начало до окончания таймера.

[Коты](#коты), которые несли [рыбу](#рыбу) -- продолжают её нести. Если они её [уронят](#выловленная-рыба), то сразу же переходят в состояние сбегания.

Стадия заканчивается после того как [рыба](#рыба) перестанет клевать и все [коты](#коты) разбегутся.

#### Finish

Особое состояние. В нём происходит подсчёт окончательный [подсчёт очков](#очки).



## Очки


[Игрок](#игрок) получает очки за:

- Быстрое реагирование на клёв рыбы. Зависит от времени, прошедшего с начала клёва до взятия удочки. Событие выбрасывается удочкой.
- За вылов рыбы. За сам факт пойманной рыбы. Зависит от параметров вылова рыбы и затраченного времени. Событие выбрасывается удочкой.
- За шлепки/щелбаны/убер-щелбаны по котам. Зависит от типа удара и типа кота. Событие выбрасывается игроком.
- За сохранённую рыбу на конец игры. Зависит от типа рыбы. Считается отдельно в конце игры.

За подсчёт очков отвечает [глобальное игровое состояние](#глобальное-игровое-состояние).


## Удочка

С помощью удочки можно вылавливать [рыбу](#рыба).

Удочка пассивно лежит на опоре, пока не начнёт клевать. После клёва у [игрока](#игрок) есть небольшой промежуток времени, чтобы схватить удочку.

После того, как удочка схвачена, нужно вытозить [рыбу](#рыба) из воды. Для этого нужно плавно двигать мышкой в сторону, противоположную той, куда тянет [рыба](#рыба) ([рыбу](#рыба) можно отследить по волнам на воде). Но при этом не слишком сильно -- иначе [рыба](#рыба) сорвётся! Силу натяжения можно отследить по излому удочки. Если достаточное сильно тянуть достаточное долго, то [рыбу](#рыба) выкинет на берег и удочка переходит в состояние "ожидания клёва".

Повдение рыбы зависит от вида [рыбы](#рыба) и от натяжения удочки.


## Рыба

Рыба может быть разных видов, и это влияет на все её характеристики и стоимость.

Также у рыбы есть _длина_, которая зависит от того, как быстро [игрок](#игрок) выловил рыбу. Немного влияет на стоимость рыбы при подсчёте [очков](#очки)

### Выловленная рыба

Рыба переодически прыгает на земле. Изначальная траектория прыжков вычисляется случайно, а затем изменяется исходя от траектории последнего прыжка.

Рыба может выпрыгнуть с [игрового поля](#игровое-поле) или вернуться в воду.

[Игрок](#игрок) может перемещать выловленную рыбу по [игровому полю](#игровое-поле). Так, в теории, он будет стремиться сложить её в кучу.


## Коты

Коты, которые идут к ближайшей [рыбе](#выловленная-рыба), забирают её себе и пытаются унести её за игровое поле.

Все коты так или иначе реагируют на [удары](#удары), и обладают особым состоянием _"Сбегание"_, в котором они не могут воровать рыбу, не могут получать урон, и пытаются сбежать с [игрового поля](#игровое-поле).

### Виды котов

Коты разделяются на виды. Каждый вид обладает уникальным идентифицирующим головным убором (кроме [обычного кота](#обычный-кот)) и ведёт себя по-своему (разный набор или характер состояний).

#### Обычный кот

Ничего особенного.

#### Кот с ведром на голове

Чтобы выпнуть этого кота нужно два [убер-щелбана](#удары). Первый щелбан нужен для того, чтобы сбить ведро с головы.

Кот реагирует на удары по разному в зависимости от наличия ведра на голове. Без ведра ведёт себя как обычный кот. С ведром реагирует только на [убер-щелбан](#удары).

#### Парашютист

Появляется в случайном месте [игрового поля](#игровое-поле), кроме воды.

#### Водолаз

Вылезает на [игровое поле](#игровое-поле) прямо из воды.

#### Кот с удочкой

Не доходя до рыбы, ловит её и постепенно притягивает к себе. В это время другие [коты](#коты) могут взять эту рыбу.

#### Спортсмен

Быстрый кот.
